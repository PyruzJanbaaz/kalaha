https://github.com/heytechv/springboot-keycloak-angular



import { Injectable } from '@angular/core';
import { Client, Message } from '@stomp/stompjs';

@Injectable({
  providedIn: 'root'
})
export class WebSocketService {
  private stompClient: Client;

  constructor() {
    this.stompClient = new Client({
      brokerURL: 'ws://localhost:3000/socket',
      debug: function (str) {
        console.log(str);
      },
      reconnectDelay: 5000,
      heartbeatIncoming: 4000,
      heartbeatOutgoing: 4000,
    });
    this.stompClient.onConnect = () => {
      this.stompClient.subscribe('/topic/messages', (message: Message) => {
        console.log('Received message:', message.body);
      });
    };
    this.stompClient.activate();
  }

  // we do not need to send the message to the server
  sendMessage(message: string): void {
    this.stompClient.publish({ destination: '/send/message', body: message });
  }
}

